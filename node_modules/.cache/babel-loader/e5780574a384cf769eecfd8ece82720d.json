{"ast":null,"code":"import EventEmitterMethods from '../../utils/eventemitter/EventEmitterMethods.js';\nimport GetSceneObject from '../../utils/system/GetSceneObject.js';\nconst GetValue = Phaser.Utils.Objects.GetValue;\n\nclass Button {\n  constructor(gameObject, config) {\n    this.gameObject = gameObject;\n    this.scene = GetSceneObject(gameObject); // Event emitter\n\n    this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\n    this._enable = undefined;\n    gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\n    this.resetFromJSON(config);\n    this.boot();\n  }\n\n  resetFromJSON(o) {\n    this.pointer = undefined;\n    this.lastClickTime = undefined;\n    this.setEnable(GetValue(o, \"enable\", true));\n    this.setMode(GetValue(o, \"mode\", 1));\n    this.setClickInterval(GetValue(o, \"clickInterval\", 100));\n    this.setDragThreshold(GetValue(o, 'threshold', undefined));\n    return this;\n  }\n\n  boot() {\n    this.gameObject.on('pointerdown', this.onPress, this);\n    this.gameObject.on('pointerup', this.onRelease, this);\n    this.gameObject.on('pointerout', this.onPointOut, this);\n    this.gameObject.on('pointermove', this.onMove, this);\n    this.gameObject.on('destroy', this.destroy, this);\n  }\n\n  shutdown() {\n    this.destroyEventEmitter();\n    this.pointer = null;\n    this.gameObject = null;\n    this.scene = null; // gameObject events will be removed when this gameObject destroyed \n  }\n\n  destroy() {\n    this.shutdown();\n  }\n\n  get enable() {\n    return this._enable;\n  }\n\n  set enable(e) {\n    if (this._enable === e) {\n      return;\n    }\n\n    if (!e) {\n      this.cancel();\n    }\n\n    this._enable = e;\n    var eventName = e ? 'enable' : 'disable';\n    this.emit(eventName, this, this.gameObject);\n  }\n\n  setEnable(e) {\n    if (e === undefined) {\n      e = true;\n    }\n\n    this.enable = e;\n    return this;\n  }\n\n  toggleEnable() {\n    this.setEnable(!this.enable);\n    return this;\n  }\n\n  setMode(m) {\n    if (typeof m === 'string') {\n      m = CLICKMODE[m];\n    }\n\n    this.mode = m;\n    return this;\n  }\n\n  setClickInterval(interval) {\n    this.clickInterval = interval; // ms\n\n    return this;\n  }\n\n  setDragThreshold(distance) {\n    this.dragThreshold = distance;\n    return this;\n  } // internal\n\n\n  onPress(pointer, localX, localY, event) {\n    if (this.pointer !== undefined) {\n      return;\n    }\n\n    this.pointer = pointer;\n\n    if (this.mode === 0) {\n      this.click(pointer.downTime, pointer, event);\n    }\n  }\n\n  onRelease(pointer, localX, localY, event) {\n    if (this.pointer !== pointer) {\n      return;\n    }\n\n    if (this.mode === 1) {\n      this.click(pointer.upTime, pointer, event);\n    }\n\n    this.pointer = undefined;\n  }\n\n  onPointOut(pointer, event) {\n    if (this.pointer !== pointer) {\n      return;\n    }\n\n    this.cancel();\n  }\n\n  onMove(pointer, localX, localY, event) {\n    if (this.pointer !== pointer) {\n      return;\n    }\n\n    if (this.dragThreshold === undefined) {\n      return;\n    }\n\n    if (pointer.getDistance() >= this.dragThreshold) {\n      this.cancel();\n    }\n  }\n\n  click(nowTime, pointer, event) {\n    if (!this.enable) {\n      return this;\n    }\n\n    if (nowTime === undefined) {\n      // fires 'click' event manually\n      this.emit('click', this, this.gameObject, pointer, event);\n      return this;\n    }\n\n    this.pointer = undefined;\n    var lastClickTime = this.lastClickTime;\n\n    if (lastClickTime !== undefined && nowTime - lastClickTime <= this.clickInterval) {\n      return this;\n    }\n\n    this.lastClickTime = nowTime;\n    this.emit('click', this, this.gameObject, pointer, event);\n    return this;\n  }\n\n  cancel() {\n    this.pointer = undefined;\n    return this;\n  }\n\n}\n\nObject.assign(Button.prototype, EventEmitterMethods);\nconst CLICKMODE = {\n  press: 0,\n  pointerdown: 0,\n  release: 1,\n  pointerup: 1\n};\nexport default Button;","map":{"version":3,"sources":["/home/jon/code/Projects/Soulys/frontend/node_modules/phaser3-rex-plugins/plugins/input/button/Button.js"],"names":["EventEmitterMethods","GetSceneObject","GetValue","Phaser","Utils","Objects","Button","constructor","gameObject","config","scene","setEventEmitter","undefined","_enable","setInteractive","resetFromJSON","boot","o","pointer","lastClickTime","setEnable","setMode","setClickInterval","setDragThreshold","on","onPress","onRelease","onPointOut","onMove","destroy","shutdown","destroyEventEmitter","enable","e","cancel","eventName","emit","toggleEnable","m","CLICKMODE","mode","interval","clickInterval","distance","dragThreshold","localX","localY","event","click","downTime","upTime","getDistance","nowTime","Object","assign","prototype","press","pointerdown","release","pointerup"],"mappings":"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","sourcesContent":["import EventEmitterMethods from '../../utils/eventemitter/EventEmitterMethods.js';\r\nimport GetSceneObject from '../../utils/system/GetSceneObject.js';\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Button {\r\n    constructor(gameObject, config) {\r\n        this.gameObject = gameObject;\r\n        this.scene = GetSceneObject(gameObject);\r\n        // Event emitter\r\n        this.setEventEmitter(GetValue(config, 'eventEmitter', undefined));\r\n\r\n        this._enable = undefined;\r\n        gameObject.setInteractive(GetValue(config, \"inputConfig\", undefined));\r\n        this.resetFromJSON(config);\r\n        this.boot();\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        this.pointer = undefined;\r\n        this.lastClickTime = undefined;\r\n        this.setEnable(GetValue(o, \"enable\", true));\r\n        this.setMode(GetValue(o, \"mode\", 1));\r\n        this.setClickInterval(GetValue(o, \"clickInterval\", 100));\r\n        this.setDragThreshold(GetValue(o, 'threshold', undefined));\r\n        return this;\r\n    }\r\n\r\n    boot() {\r\n        this.gameObject.on('pointerdown', this.onPress, this);\r\n        this.gameObject.on('pointerup', this.onRelease, this);\r\n        this.gameObject.on('pointerout', this.onPointOut, this);\r\n        this.gameObject.on('pointermove', this.onMove, this);\r\n        this.gameObject.on('destroy', this.destroy, this);\r\n    }\r\n\r\n    shutdown() {\r\n        this.destroyEventEmitter();\r\n        this.pointer = null;\r\n        this.gameObject = null;\r\n        this.scene = null;\r\n        // gameObject events will be removed when this gameObject destroyed \r\n    }\r\n\r\n    destroy() {\r\n        this.shutdown();\r\n    }\r\n\r\n    get enable() {\r\n        return this._enable;\r\n    }\r\n\r\n    set enable(e) {\r\n        if (this._enable === e) {\r\n            return;\r\n        }\r\n\r\n        if (!e) {\r\n            this.cancel();\r\n        }\r\n        this._enable = e;\r\n\r\n        var eventName = (e) ? 'enable' : 'disable';\r\n        this.emit(eventName, this, this.gameObject);\r\n    }\r\n\r\n    setEnable(e) {\r\n        if (e === undefined) {\r\n            e = true;\r\n        }\r\n\r\n        this.enable = e;\r\n        return this;\r\n    }\r\n\r\n    toggleEnable() {\r\n        this.setEnable(!this.enable);\r\n        return this;\r\n    }\r\n\r\n    setMode(m) {\r\n        if (typeof (m) === 'string') {\r\n            m = CLICKMODE[m];\r\n        }\r\n        this.mode = m;\r\n        return this;\r\n    }\r\n\r\n    setClickInterval(interval) {\r\n        this.clickInterval = interval; // ms\r\n        return this;\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n\r\n    // internal\r\n    onPress(pointer, localX, localY, event) {\r\n        if (this.pointer !== undefined) {\r\n            return;\r\n        }\r\n        this.pointer = pointer;\r\n        if (this.mode === 0) {\r\n            this.click(pointer.downTime, pointer, event);\r\n        }\r\n    }\r\n\r\n    onRelease(pointer, localX, localY, event) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        if (this.mode === 1) {\r\n            this.click(pointer.upTime, pointer, event);\r\n        }\r\n        this.pointer = undefined;\r\n    }\r\n\r\n    onPointOut(pointer, event) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n        this.cancel();\r\n    }\r\n\r\n    onMove(pointer, localX, localY, event) {\r\n        if (this.pointer !== pointer) {\r\n            return;\r\n        }\r\n\r\n        if (this.dragThreshold === undefined) {\r\n            return;\r\n        }\r\n\r\n        if (pointer.getDistance() >= this.dragThreshold) {\r\n            this.cancel();\r\n        }\r\n    }\r\n\r\n    click(nowTime, pointer, event) {\r\n        if (!this.enable) {\r\n            return this;\r\n        }\r\n\r\n        if (nowTime === undefined) {\r\n            // fires 'click' event manually\r\n            this.emit('click', this, this.gameObject, pointer, event);\r\n            return this;\r\n        }\r\n\r\n        this.pointer = undefined;\r\n        var lastClickTime = this.lastClickTime;\r\n        if ((lastClickTime !== undefined) &&\r\n            ((nowTime - lastClickTime) <= this.clickInterval)) {\r\n            return this;\r\n        }\r\n        this.lastClickTime = nowTime;\r\n        this.emit('click', this, this.gameObject, pointer, event);\r\n        return this;\r\n    }\r\n\r\n    cancel() {\r\n        this.pointer = undefined;\r\n        return this;\r\n    }\r\n}\r\n\r\nObject.assign(\r\n    Button.prototype,\r\n    EventEmitterMethods\r\n);\r\n\r\nconst CLICKMODE = {\r\n    press: 0,\r\n    pointerdown: 0,\r\n    release: 1,\r\n    pointerup: 1,\r\n};\r\n\r\nexport default Button;"]},"metadata":{},"sourceType":"module"}