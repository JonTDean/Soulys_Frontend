{"ast":null,"code":"import Render from './render/Render.js';\nimport TextStyle from './textstyle/TextStyle.js'; // extended\n\nimport CanvasTextKlass from './canvastext/CanvasText.js';\nimport Pool from '../../../pool.js';\nimport CONST from './const.js';\nimport GetGlobImageManager from './imagemanager/GetGlobImageManager.js';\nconst AddToDOM = Phaser.DOM.AddToDOM;\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\nconst GameObject = Phaser.GameObjects.GameObject;\nconst GetValue = Phaser.Utils.Objects.GetValue;\nconst RemoveFromDOM = Phaser.DOM.RemoveFromDOM;\nconst SPLITREGEXP = CONST.SPLITREGEXP;\nvar PensPools = {};\n\nclass Text extends GameObject {\n  constructor(scene, x, y, text, style, type, parser) {\n    if (x === undefined) {\n      x = 0;\n    }\n\n    if (y === undefined) {\n      y = 0;\n    }\n\n    super(scene, type);\n    this.renderer = scene.sys.game.renderer;\n    this.setPosition(x, y);\n    this.setOrigin(0, 0);\n    this.initPipeline();\n    this.canvas = CanvasPool.create(this);\n    this.context = this.canvas.getContext('2d');\n\n    if (style) {\n      // Override align\n      if (style.hasOwnProperty('align')) {\n        var halign = style.align;\n        delete style.align;\n        style.halign = halign;\n      } // Has Stroke color but stroke thinkness, set stroke thinkness to 1\n\n\n      if (style.hasOwnProperty('stroke') && !style.hasOwnProperty('strokeThickness')) {\n        style.strokeThickness = 1;\n      }\n    }\n\n    this.style = new TextStyle(this, style);\n    this.autoRound = true;\n    this._text = undefined;\n    this.padding = {\n      left: 0,\n      right: 0,\n      top: 0,\n      bottom: 0\n    };\n    this.width = 1;\n    this.height = 1;\n    this.dirty = false; //  If resolution wasn't set, then we get it from the game config\n\n    if (this.style.resolution === 0) {\n      this.style.resolution = scene.sys.game.config.resolution;\n    }\n\n    this._crop = this.resetCropObject(); //  Create a Texture for this Text object\n\n    this.texture = scene.sys.textures.addCanvas(null, this.canvas, true); //  Get the frame\n\n    this.frame = this.texture.get(); //  Set the resolution\n\n    this.frame.source.resolution = this.style.resolution;\n\n    if (this.renderer.gl) {\n      //  Clear the default 1x1 glTexture, as we override it later\n      this.renderer.deleteTexture(this.frame.source.glTexture);\n      this.frame.source.glTexture = null;\n    }\n\n    if (!PensPools.hasOwnProperty(type)) {\n      PensPools[type] = new Pool();\n    }\n\n    this.canvasText = new CanvasTextKlass({\n      parent: this,\n      context: this.context,\n      parser: parser,\n      style: this.style,\n      pensPool: PensPools[type]\n    }); //this.initRTL();\n\n    if (style && style.padding) {\n      this.setPadding(style.padding);\n    }\n\n    this.setText(text);\n    scene.sys.game.events.on('contextrestored', function () {\n      this.dirty = true;\n    }, this);\n  }\n\n  set text(value) {\n    this.setText(value);\n  }\n\n  get text() {\n    return this._text;\n  }\n\n  initRTL() {\n    if (!this.style.rtl) {\n      return;\n    } //  Here is where the crazy starts.\n    //\n    //  Due to browser implementation issues, you cannot fillText BiDi text to a canvas\n    //  that is not part of the DOM. It just completely ignores the direction property.\n\n\n    this.canvas.dir = 'rtl'; //  Experimental atm, but one day ...\n\n    this.context.direction = 'rtl'; //  Add it to the DOM, but hidden within the parent canvas.\n\n    this.canvas.style.display = 'none';\n    AddToDOM(this.canvas, this.scene.sys.canvas); //  And finally we set the x origin\n\n    this.originX = 1;\n  }\n\n  setText(value) {\n    if (!value && value !== 0) {\n      value = '';\n    }\n\n    if (Array.isArray(value)) {\n      value = value.join('\\n');\n    }\n\n    if (value !== this._text) {\n      this._text = value.toString();\n      this.updateText();\n    }\n\n    return this;\n  }\n\n  setStyle(style) {\n    return this.style.setStyle(style);\n  }\n\n  setFont(font) {\n    return this.style.setFont(font);\n  }\n\n  setFontFamily(family) {\n    return this.style.setFontFamily(family);\n  }\n\n  setFontSize(size) {\n    return this.style.setFontSize(size);\n  }\n\n  setFontStyle(style) {\n    return this.style.setFontStyle(style);\n  }\n\n  setFixedSize(width, height) {\n    return this.style.setFixedSize(width, height);\n  }\n\n  setBackgroundColor(color) {\n    return this.style.setBackgroundColor(color);\n  }\n\n  setFill(color) {\n    return this.style.setFill(color);\n  }\n\n  setColor(color) {\n    return this.style.setColor(color);\n  }\n\n  setStroke(color, thickness) {\n    return this.style.setStroke(color, thickness);\n  }\n\n  setShadow(x, y, color, blur, shadowStroke, shadowFill) {\n    return this.style.setShadow(x, y, color, blur, shadowStroke, shadowFill);\n  }\n\n  setShadowOffset(x, y) {\n    return this.style.setShadowOffset(x, y);\n  }\n\n  setShadowColor(color) {\n    return this.style.setShadowColor(color);\n  }\n\n  setShadowBlur(blur) {\n    return this.style.setShadowBlur(blur);\n  }\n\n  setShadowStroke(enabled) {\n    return this.style.setShadowStroke(enabled);\n  }\n\n  setShadowFill(enabled) {\n    return this.style.setShadowFill(enabled);\n  }\n\n  setWrapMode(mode) {\n    return this.style.setWrapMode(mode);\n  }\n\n  setWrapWidth(width) {\n    return this.style.setWrapWidth(width);\n  }\n\n  setAlign(align) {\n    return this.style.setHAlign(align);\n  }\n\n  setLineSpacing(value) {\n    return this.style.setLineSpacing(value);\n  }\n\n  setPadding(left, top, right, bottom) {\n    if (typeof left === 'object') {\n      var config = left; //  If they specify x and/or y this applies to all\n\n      var x = GetValue(config, 'x', null);\n\n      if (x !== null) {\n        left = x;\n        right = x;\n      } else {\n        left = GetValue(config, 'left', 0);\n        right = GetValue(config, 'right', left);\n      }\n\n      var y = GetValue(config, 'y', null);\n\n      if (y !== null) {\n        top = y;\n        bottom = y;\n      } else {\n        top = GetValue(config, 'top', 0);\n        bottom = GetValue(config, 'bottom', top);\n      }\n    } else {\n      if (left === undefined) {\n        left = 0;\n      }\n\n      if (top === undefined) {\n        top = left;\n      }\n\n      if (right === undefined) {\n        right = left;\n      }\n\n      if (bottom === undefined) {\n        bottom = top;\n      }\n    }\n\n    this.padding.left = left;\n    this.padding.top = top;\n    this.padding.right = right;\n    this.padding.bottom = bottom;\n    return this.updateText(false);\n  }\n\n  setResolution(value) {\n    return this.style.setResolution(value);\n  }\n\n  setMaxLines(max) {\n    return this.style.setMaxLines(max);\n  }\n\n  updateText(runWrap) {\n    if (runWrap === undefined) {\n      runWrap = true;\n    }\n\n    var canvasText = this.canvasText; // wrap text to pens\n\n    var style = this.style;\n\n    if (runWrap) {\n      canvasText.updatePenManager(this._text, style.wrapMode, style.wrapWidth, style.lineHeight);\n    } // resize\n\n\n    var padding = this.padding;\n    var textWidth, textHeight;\n\n    if (style.fixedWidth === 0) {\n      this.width = canvasText.linesWidth + padding.left + padding.right;\n      textWidth = canvasText.linesWidth;\n    } else {\n      this.width = style.fixedWidth;\n      textWidth = this.width - padding.left - padding.right;\n\n      if (textWidth < canvasText.linesWidth) {\n        textWidth = canvasText.linesWidth;\n      }\n    }\n\n    if (style.fixedHeight === 0) {\n      this.height = canvasText.linesHeight + padding.top + padding.bottom;\n      textHeight = canvasText.linesHeight;\n    } else {\n      this.height = style.fixedHeight;\n      textHeight = this.height - padding.top - padding.bottom;\n\n      if (textHeight < canvasText.linesHeight) {\n        textHeight = canvasText.linesHeight;\n      }\n    }\n\n    var w = this.width;\n    var h = this.height;\n    this.updateDisplayOrigin();\n    var resolution = style.resolution;\n    w *= resolution;\n    h *= resolution;\n    w = Math.max(Math.ceil(w), 1);\n    h = Math.max(Math.ceil(h), 1);\n    var canvas = this.canvas;\n    var context = this.context;\n\n    if (canvas.width !== w || canvas.height !== h) {\n      canvas.width = w;\n      canvas.height = h;\n      this.frame.setSize(w, h);\n    } else {\n      context.clearRect(0, 0, w, h);\n    }\n\n    context.save();\n    context.scale(resolution, resolution); // draw\n\n    canvasText.draw(padding.left, padding.top, textWidth, textHeight);\n    context.restore();\n\n    if (this.renderer.gl) {\n      this.frame.source.glTexture = this.renderer.canvasToTexture(canvas, this.frame.source.glTexture, true);\n      this.frame.glTexture = this.frame.source.glTexture;\n    }\n\n    this.dirty = true;\n    var input = this.input;\n\n    if (input && !input.customHitArea) {\n      input.hitArea.width = this.width;\n      input.hitArea.height = this.height;\n    }\n\n    return this;\n  }\n\n  getTextMetrics() {\n    return this.style.getTextMetrics();\n  }\n\n  toJSON() {\n    var out = Components.ToJSON(this); //  Extra Text data is added here\n\n    var data = {\n      autoRound: this.autoRound,\n      text: this._text,\n      style: this.style.toJSON(),\n      resolution: this.resolution,\n      padding: {\n        left: this.padding.left,\n        right: this.padding.right,\n        top: this.padding.top,\n        bottom: this.padding.bottom\n      }\n    };\n    out.data = data;\n    return out;\n  }\n\n  preDestroy() {\n    if (this.style.rtl) {\n      RemoveFromDOM(this.canvas);\n    }\n\n    CanvasPool.remove(this.canvas);\n    this.canvasText.destroy();\n  }\n\n  setInteractive(shape, callback, dropZone) {\n    GameObject.prototype.setInteractive.call(this, shape, callback, dropZone);\n    this.canvasText.setInteractive();\n    return this;\n  }\n\n  getWrappedText(text, start, end) {\n    text = this.canvasText.getText(text, start, end, true);\n    return text.split(SPLITREGEXP);\n  }\n\n  getPlainText(text, start, end) {\n    return this.canvasText.getPlainText(text, start, end);\n  }\n\n  getText(text, start, end) {\n    return this.canvasText.getText(text, start, end, false);\n  }\n\n  getSubString(text, start, end) {\n    return this.getText(text, start, end);\n  }\n\n  copyPenManager(penManager) {\n    return this.canvasText.copyPenManager(penManager);\n  }\n\n  getPenManager(text, penManager) {\n    return this.canvasText.getPenManager(text, penManager);\n  }\n\n  setSize(width, height) {\n    return this.setFixedSize(width, height);\n  }\n\n  resize(width, height) {\n    return this.setFixedSize(width, height);\n  }\n\n  set lineSpacing(value) {\n    this.setLineSpacing(value);\n  }\n\n  get lineSpacing() {\n    return this.style.lineSpacing;\n  }\n\n  get imageManager() {\n    return GetGlobImageManager(this.scene.textures);\n  }\n\n  addImage(key, config) {\n    this.imageManager.add(key, config);\n    return this;\n  }\n\n  drawAreaBounds(graphics, color) {\n    this.canvasText.hitAreaManager.drawBounds(graphics, color, this);\n    return this;\n  }\n\n}\n\nconst Components = Phaser.GameObjects.Components;\nPhaser.Class.mixin(Text, [Components.Alpha, Components.BlendMode, Components.ComputedSize, Components.Crop, Components.Depth, Components.Flip, Components.GetBounds, Components.Mask, Components.Origin, Components.Pipeline, Components.ScrollFactor, Components.Tint, Components.Transform, Components.Visible, Render]);\nexport default Text;","map":{"version":3,"sources":["/home/jon/code/Projects/Soulys/frontend/node_modules/phaser3-rex-plugins/plugins/gameobjects/text/textbase/Text.js"],"names":["Render","TextStyle","CanvasTextKlass","Pool","CONST","GetGlobImageManager","AddToDOM","Phaser","DOM","CanvasPool","Display","Canvas","GameObject","GameObjects","GetValue","Utils","Objects","RemoveFromDOM","SPLITREGEXP","PensPools","Text","constructor","scene","x","y","text","style","type","parser","undefined","renderer","sys","game","setPosition","setOrigin","initPipeline","canvas","create","context","getContext","hasOwnProperty","halign","align","strokeThickness","autoRound","_text","padding","left","right","top","bottom","width","height","dirty","resolution","config","_crop","resetCropObject","texture","textures","addCanvas","frame","get","source","gl","deleteTexture","glTexture","canvasText","parent","pensPool","setPadding","setText","events","on","value","initRTL","rtl","dir","direction","display","originX","Array","isArray","join","toString","updateText","setStyle","setFont","font","setFontFamily","family","setFontSize","size","setFontStyle","setFixedSize","setBackgroundColor","color","setFill","setColor","setStroke","thickness","setShadow","blur","shadowStroke","shadowFill","setShadowOffset","setShadowColor","setShadowBlur","setShadowStroke","enabled","setShadowFill","setWrapMode","mode","setWrapWidth","setAlign","setHAlign","setLineSpacing","setResolution","setMaxLines","max","runWrap","updatePenManager","wrapMode","wrapWidth","lineHeight","textWidth","textHeight","fixedWidth","linesWidth","fixedHeight","linesHeight","w","h","updateDisplayOrigin","Math","ceil","setSize","clearRect","save","scale","draw","restore","canvasToTexture","input","customHitArea","hitArea","getTextMetrics","toJSON","out","Components","ToJSON","data","preDestroy","remove","destroy","setInteractive","shape","callback","dropZone","prototype","call","getWrappedText","start","end","getText","split","getPlainText","getSubString","copyPenManager","penManager","getPenManager","resize","lineSpacing","imageManager","addImage","key","add","drawAreaBounds","graphics","hitAreaManager","drawBounds","Class","mixin","Alpha","BlendMode","ComputedSize","Crop","Depth","Flip","GetBounds","Mask","Origin","Pipeline","ScrollFactor","Tint","Transform","Visible"],"mappings":"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","sourcesContent":["import Render from './render/Render.js';\r\nimport TextStyle from './textstyle/TextStyle.js'; // extended\r\nimport CanvasTextKlass from './canvastext/CanvasText.js';\r\nimport Pool from '../../../pool.js';\r\nimport CONST from './const.js';\r\nimport GetGlobImageManager from './imagemanager/GetGlobImageManager.js';\r\n\r\nconst AddToDOM = Phaser.DOM.AddToDOM;\r\nconst CanvasPool = Phaser.Display.Canvas.CanvasPool;\r\nconst GameObject = Phaser.GameObjects.GameObject;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\nconst RemoveFromDOM = Phaser.DOM.RemoveFromDOM;\r\nconst SPLITREGEXP = CONST.SPLITREGEXP;\r\n\r\nvar PensPools = {};\r\n\r\nclass Text extends GameObject {\r\n    constructor(scene, x, y, text, style, type, parser) {\r\n        if (x === undefined) {\r\n            x = 0;\r\n        }\r\n        if (y === undefined) {\r\n            y = 0;\r\n        }\r\n\r\n        super(scene, type);\r\n\r\n        this.renderer = scene.sys.game.renderer;\r\n\r\n        this.setPosition(x, y);\r\n        this.setOrigin(0, 0);\r\n        this.initPipeline();\r\n\r\n        this.canvas = CanvasPool.create(this);\r\n\r\n        this.context = this.canvas.getContext('2d');\r\n\r\n        if (style) {\r\n            // Override align\r\n            if (style.hasOwnProperty('align')) {\r\n                var halign = style.align;\r\n                delete style.align;\r\n                style.halign = halign;\r\n            }\r\n            // Has Stroke color but stroke thinkness, set stroke thinkness to 1\r\n            if (style.hasOwnProperty('stroke') && !style.hasOwnProperty('strokeThickness')) {\r\n                style.strokeThickness = 1;\r\n            }\r\n        }\r\n        this.style = new TextStyle(this, style);\r\n\r\n        this.autoRound = true;\r\n\r\n        this._text = undefined;\r\n\r\n        this.padding = {\r\n            left: 0,\r\n            right: 0,\r\n            top: 0,\r\n            bottom: 0\r\n        };\r\n\r\n        this.width = 1;\r\n\r\n        this.height = 1;\r\n\r\n        this.dirty = false;\r\n\r\n        //  If resolution wasn't set, then we get it from the game config\r\n        if (this.style.resolution === 0) {\r\n            this.style.resolution = scene.sys.game.config.resolution;\r\n        }\r\n\r\n        this._crop = this.resetCropObject();\r\n\r\n        //  Create a Texture for this Text object\r\n        this.texture = scene.sys.textures.addCanvas(null, this.canvas, true);\r\n\r\n        //  Get the frame\r\n        this.frame = this.texture.get();\r\n\r\n        //  Set the resolution\r\n        this.frame.source.resolution = this.style.resolution;\r\n\r\n        if (this.renderer.gl) {\r\n            //  Clear the default 1x1 glTexture, as we override it later\r\n\r\n            this.renderer.deleteTexture(this.frame.source.glTexture);\r\n\r\n            this.frame.source.glTexture = null;\r\n        }\r\n\r\n        if (!PensPools.hasOwnProperty(type)) {\r\n            PensPools[type] = new Pool();\r\n        }\r\n        this.canvasText = new CanvasTextKlass({\r\n            parent: this,\r\n            context: this.context,\r\n            parser: parser,\r\n            style: this.style,\r\n            pensPool: PensPools[type]\r\n        });\r\n\r\n        //this.initRTL();\r\n\r\n        if (style && style.padding) {\r\n            this.setPadding(style.padding);\r\n        }\r\n\r\n        this.setText(text);\r\n\r\n        scene.sys.game.events.on('contextrestored', function () {\r\n            this.dirty = true;\r\n        }, this);\r\n    }\r\n\r\n    set text(value) {\r\n        this.setText(value);\r\n    }\r\n    get text() {\r\n        return this._text;\r\n    }\r\n\r\n    initRTL() {\r\n        if (!this.style.rtl) {\r\n            return;\r\n        }\r\n\r\n        //  Here is where the crazy starts.\r\n        //\r\n        //  Due to browser implementation issues, you cannot fillText BiDi text to a canvas\r\n        //  that is not part of the DOM. It just completely ignores the direction property.\r\n\r\n        this.canvas.dir = 'rtl';\r\n\r\n        //  Experimental atm, but one day ...\r\n        this.context.direction = 'rtl';\r\n\r\n        //  Add it to the DOM, but hidden within the parent canvas.\r\n        this.canvas.style.display = 'none';\r\n\r\n        AddToDOM(this.canvas, this.scene.sys.canvas);\r\n\r\n        //  And finally we set the x origin\r\n        this.originX = 1;\r\n    }\r\n\r\n    setText(value) {\r\n        if (!value && value !== 0) {\r\n            value = '';\r\n        }\r\n\r\n        if (Array.isArray(value)) {\r\n            value = value.join('\\n');\r\n        }\r\n\r\n        if (value !== this._text) {\r\n            this._text = value.toString();\r\n\r\n            this.updateText();\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    setStyle(style) {\r\n        return this.style.setStyle(style);\r\n    }\r\n\r\n    setFont(font) {\r\n        return this.style.setFont(font);\r\n    }\r\n\r\n    setFontFamily(family) {\r\n        return this.style.setFontFamily(family);\r\n    }\r\n\r\n    setFontSize(size) {\r\n        return this.style.setFontSize(size);\r\n    }\r\n\r\n    setFontStyle(style) {\r\n        return this.style.setFontStyle(style);\r\n    }\r\n\r\n    setFixedSize(width, height) {\r\n        return this.style.setFixedSize(width, height);\r\n    }\r\n\r\n    setBackgroundColor(color) {\r\n        return this.style.setBackgroundColor(color);\r\n    }\r\n\r\n    setFill(color) {\r\n        return this.style.setFill(color);\r\n    }\r\n\r\n    setColor(color) {\r\n        return this.style.setColor(color);\r\n    }\r\n\r\n    setStroke(color, thickness) {\r\n        return this.style.setStroke(color, thickness);\r\n    }\r\n\r\n    setShadow(x, y, color, blur, shadowStroke, shadowFill) {\r\n        return this.style.setShadow(x, y, color, blur, shadowStroke, shadowFill);\r\n    }\r\n\r\n    setShadowOffset(x, y) {\r\n        return this.style.setShadowOffset(x, y);\r\n    }\r\n\r\n    setShadowColor(color) {\r\n        return this.style.setShadowColor(color);\r\n    }\r\n\r\n    setShadowBlur(blur) {\r\n        return this.style.setShadowBlur(blur);\r\n    }\r\n\r\n    setShadowStroke(enabled) {\r\n        return this.style.setShadowStroke(enabled);\r\n    }\r\n\r\n    setShadowFill(enabled) {\r\n        return this.style.setShadowFill(enabled);\r\n    }\r\n\r\n    setWrapMode(mode) {\r\n        return this.style.setWrapMode(mode);\r\n    }\r\n\r\n    setWrapWidth(width) {\r\n        return this.style.setWrapWidth(width);\r\n    }\r\n\r\n    setAlign(align) {\r\n        return this.style.setHAlign(align);\r\n    }\r\n\r\n    setLineSpacing(value) {\r\n        return this.style.setLineSpacing(value);\r\n    }\r\n\r\n    setPadding(left, top, right, bottom) {\r\n        if (typeof left === 'object') {\r\n            var config = left;\r\n\r\n            //  If they specify x and/or y this applies to all\r\n            var x = GetValue(config, 'x', null);\r\n\r\n            if (x !== null) {\r\n                left = x;\r\n                right = x;\r\n            } else {\r\n                left = GetValue(config, 'left', 0);\r\n                right = GetValue(config, 'right', left);\r\n            }\r\n\r\n            var y = GetValue(config, 'y', null);\r\n\r\n            if (y !== null) {\r\n                top = y;\r\n                bottom = y;\r\n            } else {\r\n                top = GetValue(config, 'top', 0);\r\n                bottom = GetValue(config, 'bottom', top);\r\n            }\r\n        } else {\r\n            if (left === undefined) {\r\n                left = 0;\r\n            }\r\n            if (top === undefined) {\r\n                top = left;\r\n            }\r\n            if (right === undefined) {\r\n                right = left;\r\n            }\r\n            if (bottom === undefined) {\r\n                bottom = top;\r\n            }\r\n        }\r\n\r\n        this.padding.left = left;\r\n        this.padding.top = top;\r\n        this.padding.right = right;\r\n        this.padding.bottom = bottom;\r\n\r\n        return this.updateText(false);\r\n    }\r\n\r\n    setResolution(value) {\r\n        return this.style.setResolution(value);\r\n    }\r\n\r\n    setMaxLines(max) {\r\n        return this.style.setMaxLines(max);\r\n    }\r\n\r\n    updateText(runWrap) {\r\n        if (runWrap === undefined) {\r\n            runWrap = true;\r\n        }\r\n        var canvasText = this.canvasText;\r\n\r\n        // wrap text to pens\r\n        var style = this.style;\r\n        if (runWrap) {\r\n            canvasText.updatePenManager(\r\n                this._text,\r\n                style.wrapMode,\r\n                style.wrapWidth,\r\n                style.lineHeight\r\n            );\r\n        }\r\n\r\n        // resize\r\n        var padding = this.padding;\r\n        var textWidth, textHeight;\r\n        if (style.fixedWidth === 0) {\r\n            this.width = canvasText.linesWidth + padding.left + padding.right;\r\n            textWidth = canvasText.linesWidth;\r\n        }\r\n        else {\r\n            this.width = style.fixedWidth;\r\n            textWidth = this.width - padding.left - padding.right;\r\n            if (textWidth < canvasText.linesWidth) {\r\n                textWidth = canvasText.linesWidth;\r\n            }\r\n        }\r\n        if (style.fixedHeight === 0) {\r\n            this.height = canvasText.linesHeight + padding.top + padding.bottom;\r\n            textHeight = canvasText.linesHeight;\r\n        }\r\n        else {\r\n            this.height = style.fixedHeight;\r\n            textHeight = this.height - padding.top - padding.bottom;\r\n            if (textHeight < canvasText.linesHeight) {\r\n                textHeight = canvasText.linesHeight;\r\n            }\r\n        }\r\n\r\n        var w = this.width;\r\n        var h = this.height;\r\n\r\n        this.updateDisplayOrigin();\r\n\r\n        var resolution = style.resolution;\r\n        w *= resolution;\r\n        h *= resolution;\r\n\r\n        w = Math.max(Math.ceil(w), 1);\r\n        h = Math.max(Math.ceil(h), 1);\r\n\r\n        var canvas = this.canvas;\r\n        var context = this.context;\r\n        if (canvas.width !== w || canvas.height !== h) {\r\n            canvas.width = w;\r\n            canvas.height = h;\r\n            this.frame.setSize(w, h);\r\n        } else {\r\n            context.clearRect(0, 0, w, h);\r\n        }\r\n\r\n        context.save();\r\n        context.scale(resolution, resolution);\r\n\r\n        // draw\r\n        canvasText.draw(\r\n            padding.left,\r\n            padding.top,\r\n            textWidth,\r\n            textHeight\r\n        );\r\n\r\n        context.restore();\r\n\r\n        if (this.renderer.gl) {\r\n            this.frame.source.glTexture = this.renderer.canvasToTexture(canvas, this.frame.source.glTexture, true);\r\n            this.frame.glTexture = this.frame.source.glTexture;\r\n        }\r\n\r\n        this.dirty = true;\r\n\r\n        var input = this.input;\r\n\r\n        if (input && !input.customHitArea) {\r\n            input.hitArea.width = this.width;\r\n            input.hitArea.height = this.height;\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    getTextMetrics() {\r\n        return this.style.getTextMetrics();\r\n    }\r\n\r\n    toJSON() {\r\n        var out = Components.ToJSON(this);\r\n\r\n        //  Extra Text data is added here\r\n\r\n        var data = {\r\n            autoRound: this.autoRound,\r\n            text: this._text,\r\n            style: this.style.toJSON(),\r\n            resolution: this.resolution,\r\n            padding: {\r\n                left: this.padding.left,\r\n                right: this.padding.right,\r\n                top: this.padding.top,\r\n                bottom: this.padding.bottom\r\n            }\r\n        };\r\n\r\n        out.data = data;\r\n\r\n        return out;\r\n    }\r\n\r\n    preDestroy() {\r\n        if (this.style.rtl) {\r\n            RemoveFromDOM(this.canvas);\r\n        }\r\n\r\n        CanvasPool.remove(this.canvas);\r\n        this.canvasText.destroy();\r\n    }\r\n\r\n    setInteractive(shape, callback, dropZone) {\r\n        GameObject.prototype.setInteractive.call(this, shape, callback, dropZone);\r\n        this.canvasText.setInteractive();\r\n        return this;\r\n    }\r\n\r\n    getWrappedText(text, start, end) {\r\n        text = this.canvasText.getText(text, start, end, true);\r\n        return text.split(SPLITREGEXP);\r\n    }\r\n\r\n    getPlainText(text, start, end) {\r\n        return this.canvasText.getPlainText(text, start, end);\r\n    }\r\n\r\n    getText(text, start, end) {\r\n        return this.canvasText.getText(text, start, end, false);\r\n    }\r\n\r\n    getSubString(text, start, end) {\r\n        return this.getText(text, start, end);\r\n    }\r\n\r\n    copyPenManager(penManager) {\r\n        return this.canvasText.copyPenManager(penManager);\r\n    }\r\n\r\n    getPenManager(text, penManager) {\r\n        return this.canvasText.getPenManager(text, penManager);\r\n    }\r\n\r\n    setSize(width, height) {\r\n        return this.setFixedSize(width, height);\r\n    }\r\n\r\n    resize(width, height) {\r\n        return this.setFixedSize(width, height);\r\n    }\r\n\r\n    set lineSpacing(value) {\r\n        this.setLineSpacing(value);\r\n    }\r\n    get lineSpacing() {\r\n        return this.style.lineSpacing;\r\n    }\r\n\r\n    get imageManager() {\r\n        return GetGlobImageManager(this.scene.textures);\r\n    }\r\n\r\n    addImage(key, config) {\r\n        this.imageManager.add(key, config);\r\n        return this;\r\n    }\r\n\r\n    drawAreaBounds(graphics, color) {\r\n        this.canvasText.hitAreaManager.drawBounds(graphics, color, this);\r\n        return this;\r\n    }\r\n}\r\n\r\nconst Components = Phaser.GameObjects.Components;\r\nPhaser.Class.mixin(Text,\r\n    [\r\n        Components.Alpha,\r\n        Components.BlendMode,\r\n        Components.ComputedSize,\r\n        Components.Crop,\r\n        Components.Depth,\r\n        Components.Flip,\r\n        Components.GetBounds,\r\n        Components.Mask,\r\n        Components.Origin,\r\n        Components.Pipeline,\r\n        Components.ScrollFactor,\r\n        Components.Tint,\r\n        Components.Transform,\r\n        Components.Visible,\r\n        Render\r\n    ]\r\n);\r\n\r\nexport default Text;"]},"metadata":{},"sourceType":"module"}