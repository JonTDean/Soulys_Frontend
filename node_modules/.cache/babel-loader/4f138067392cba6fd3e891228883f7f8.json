{"ast":null,"code":"import TwoPointersTracer from '../twopointerstracer/TwoPointersTracer.js';\nimport FSM from '../../../fsm.js';\nconst GetValue = Phaser.Utils.Objects.GetValue;\n\nclass Pinch extends TwoPointersTracer {\n  constructor(scene, config) {\n    super(scene, config);\n    var self = this;\n    var stateConfig = {\n      states: {\n        IDLE: {\n          enter: function () {\n            self.prevDistance = undefined;\n            self.scaleFactor = 1;\n          }\n        },\n        BEGIN: {},\n        RECOGNIZED: {\n          enter: function () {\n            self.emit('pinchstart', self);\n          },\n          exit: function () {\n            self.emit('pinchend', self);\n          }\n        }\n      },\n      init: function () {\n        this.state = IDLE;\n      },\n      eventEmitter: false\n    };\n    this.setRecongizedStateObject(new FSM(stateConfig));\n  }\n\n  resetFromJSON(o) {\n    super.resetFromJSON(o);\n    this.setDragThreshold(GetValue(o, 'threshold', 0));\n    return this;\n  }\n\n  onDrag2Start() {\n    this.scaleFactor = 1;\n    this.prevDistance = this.distanceBetween;\n    this.state = BEGIN;\n\n    if (this.dragThreshold === 0) {\n      this.state = RECOGNIZED;\n    }\n  }\n\n  onDrag2End() {\n    this.state = IDLE;\n  }\n\n  onDrag2() {\n    switch (this.state) {\n      case BEGIN:\n        if (this.pointers[0].getDistance() >= this.dragThreshold && this.pointers[1].getDistance() >= this.dragThreshold) {\n          var curDistance = this.distanceBetween;\n          this.scaleFactor = curDistance / this.prevDistance;\n          this.prevDistance = curDistance;\n          this.state = RECOGNIZED;\n        }\n\n        break;\n\n      case RECOGNIZED:\n        var curDistance = this.distanceBetween;\n        this.scaleFactor = curDistance / this.prevDistance;\n        this.emit('pinch', this);\n        this.prevDistance = curDistance;\n        break;\n    }\n  }\n\n  get isPinch() {\n    return this.state === RECOGNIZED;\n  }\n\n  setDragThreshold(distance) {\n    this.dragThreshold = distance;\n    return this;\n  }\n\n}\n\nconst IDLE = 'IDLE';\nconst BEGIN = 'BEGIN';\nconst RECOGNIZED = 'RECOGNIZED';\nexport default Pinch;","map":{"version":3,"sources":["/home/jon/code/Projects/Soulys/frontend/node_modules/phaser3-rex-plugins/plugins/input/gestures/pinch/Pinch.js"],"names":["TwoPointersTracer","FSM","GetValue","Phaser","Utils","Objects","Pinch","constructor","scene","config","self","stateConfig","states","IDLE","enter","prevDistance","undefined","scaleFactor","BEGIN","RECOGNIZED","emit","exit","init","state","eventEmitter","setRecongizedStateObject","resetFromJSON","o","setDragThreshold","onDrag2Start","distanceBetween","dragThreshold","onDrag2End","onDrag2","pointers","getDistance","curDistance","isPinch","distance"],"mappings":"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","sourcesContent":["import TwoPointersTracer from '../twopointerstracer/TwoPointersTracer.js';\r\nimport FSM from '../../../fsm.js';\r\n\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass Pinch extends TwoPointersTracer {\r\n    constructor(scene, config) {\r\n        super(scene, config);\r\n\r\n        var self = this;\r\n        var stateConfig = {\r\n            states: {\r\n                IDLE: {\r\n                    enter: function () {\r\n                        self.prevDistance = undefined;\r\n                        self.scaleFactor = 1;\r\n                    },\r\n                },\r\n                BEGIN: {\r\n                },\r\n                RECOGNIZED: {\r\n                    enter: function () {\r\n                        self.emit('pinchstart', self);\r\n                    },\r\n                    exit: function () {\r\n                        self.emit('pinchend', self);\r\n                    }\r\n                }\r\n            },\r\n            init: function () {\r\n                this.state = IDLE;\r\n            },\r\n            eventEmitter: false,\r\n        }\r\n        this.setRecongizedStateObject(new FSM(stateConfig));\r\n    }\r\n\r\n    resetFromJSON(o) {\r\n        super.resetFromJSON(o);\r\n        this.setDragThreshold(GetValue(o, 'threshold', 0));\r\n        return this;\r\n    }\r\n\r\n    onDrag2Start() {\r\n        this.scaleFactor = 1;\r\n        this.prevDistance = this.distanceBetween;\r\n        this.state = BEGIN;\r\n        if (this.dragThreshold === 0) {\r\n            this.state = RECOGNIZED;\r\n        }\r\n    }\r\n\r\n    onDrag2End() {\r\n        this.state = IDLE;\r\n    }\r\n\r\n    onDrag2() {\r\n        switch (this.state) {\r\n            case BEGIN:\r\n                if ((this.pointers[0].getDistance() >= this.dragThreshold) &&\r\n                    (this.pointers[1].getDistance() >= this.dragThreshold)) {\r\n                    var curDistance = this.distanceBetween;\r\n                    this.scaleFactor = curDistance / this.prevDistance;\r\n                    this.prevDistance = curDistance;\r\n                    this.state = RECOGNIZED;\r\n                }\r\n                break;\r\n            case RECOGNIZED:\r\n                var curDistance = this.distanceBetween;\r\n                this.scaleFactor = curDistance / this.prevDistance;\r\n                this.emit('pinch', this);\r\n                this.prevDistance = curDistance;\r\n                break;\r\n        }\r\n    }\r\n\r\n    get isPinch() {\r\n        return (this.state === RECOGNIZED);\r\n    }\r\n\r\n    setDragThreshold(distance) {\r\n        this.dragThreshold = distance;\r\n        return this;\r\n    }\r\n}\r\n\r\nconst IDLE = 'IDLE';\r\nconst BEGIN = 'BEGIN';\r\nconst RECOGNIZED = 'RECOGNIZED';\r\n\r\nexport default Pinch;"]},"metadata":{},"sourceType":"module"}