{"ast":null,"code":"import ContainerLite from '../containerlite/ContainerLite.js';\nimport Table from './Table.js';\nimport DefaultMask from '../../utils/mask/DefaultMask.js';\nimport ResizeGameObject from '../../utils/size/ResizeGameObject.js';\nimport MaskToGameObject from '../../utils/mask/MaskToGameObject.js';\nimport Methods from './methods/Methods.js';\nconst Group = Phaser.GameObjects.Group;\nconst Components = Phaser.GameObjects.Components;\nconst Set = Phaser.Structs.Set;\nconst GetValue = Phaser.Utils.Objects.GetValue;\n\nclass GridTable extends ContainerLite {\n  constructor(scene, x, y, width, height, config) {\n    if (config === undefined) {\n      config = {};\n    }\n\n    super(scene, x, y, width, height);\n    this.type = 'rexGridTable';\n    this._tableOX = 0;\n    this._tableOY = 0;\n    this.visibleCells = new Set();\n    this.preVisibleCells = new Set();\n    this.execeedTopState = false;\n    this.execeedBottomState = false;\n    this.execeedLeftState = false;\n    this.execeedRightState = false;\n    var reuseCellContainer = GetValue(config, 'reuseCellContainer', false);\n\n    if (reuseCellContainer) {\n      this.cellContainersPool = new Group(scene); // Don't add Group into update list, I will destroy it manually\n    }\n\n    var callback = GetValue(config, 'cellVisibleCallback', null);\n\n    if (callback !== null) {\n      var scope = GetValue(config, 'cellVisibleCallbackScope', undefined);\n      this.on('cellvisible', callback, scope);\n    }\n\n    callback = GetValue(config, 'cellInvisibleCallback', null);\n\n    if (callback !== null) {\n      var scope = GetValue(config, 'cellInvisibleCallbackScope', undefined);\n      this.on('cellinvisible', callback, scope);\n    }\n\n    this.setCellsMask(GetValue(config, 'mask', true));\n    this.setScrollMode(GetValue(config, 'scrollMode', 0));\n    this.setClampMode(GetValue(config, 'clamplTableOXY', true)); // Pre-process cell size\n\n    if (this.scrollMode === 0) {\n      // scroll y\n      var cellWidth = GetValue(config, 'cellWidth', undefined);\n      this.expandCellSize = cellWidth === undefined;\n\n      if (cellWidth === undefined) {\n        var columns = GetValue(config, 'columns', 1);\n        config.cellWidth = this.width / columns;\n      }\n    } else {\n      // scroll x\n      // Swap cell width and cell height\n      var cellWidth = GetValue(config, 'cellHeight', undefined);\n      var cellHeight = GetValue(config, 'cellWidth', undefined);\n      this.expandCellSize = cellWidth === undefined;\n      config.cellWidth = cellWidth;\n      config.cellHeight = cellHeight;\n    }\n\n    this.table = new Table(this, config);\n    this.updateTable();\n  }\n\n  destroy(fromScene) {\n    //  This Game Object has already been destroyed\n    if (!this.scene) {\n      return;\n    }\n\n    if (this.maskUpdateMode === 1) {\n      this.scene.game.events.off('poststep', this.maskCells, this);\n    }\n\n    this.table.destroy(fromScene);\n    this.table = undefined;\n\n    if (this.cellContainersPool) {\n      this.cellContainersPool.destroy(true);\n      this.cellContainersPool = undefined;\n    }\n\n    super.destroy(fromScene);\n  }\n\n  setScrollMode(mode) {\n    if (typeof mode === 'string') {\n      mode = SCROLLMODE[mode.toLowerCase()];\n    }\n\n    this.scrollMode = mode;\n    return this;\n  }\n\n  setClampMode(mode) {\n    this.clampTableOXYMode = mode;\n    return this;\n  }\n\n  get tableOY() {\n    return this._tableOY;\n  }\n\n  get tableOX() {\n    return this._tableOX;\n  }\n\n  set tableOY(oy) {\n    this.setTableOY(oy).updateTable();\n  }\n\n  set tableOX(ox) {\n    this.setTableOX(ox).updateTable();\n  }\n\n  setTableOXY(ox, oy) {\n    this.setTableOY(oy).setTableOX(ox);\n    return this;\n  }\n\n  addTableOY(dy) {\n    this.setTableOY(this.tableOY + dy);\n    return this;\n  }\n\n  addTableOX(dx) {\n    this.setTableOX(this.tableOX + dx);\n    return this;\n  }\n\n  addTableOXY(dx, dy) {\n    this.addTableOY(dy).addTableOX(dx);\n    return this;\n  }\n\n  setTableOYByPercentage(percentage) {\n    this.setTableOY(-this.tableVisibleHeight * percentage);\n    return this;\n  }\n\n  getTableOYPercentage() {\n    var tableVisibleHeight = this.tableVisibleHeight;\n\n    if (tableVisibleHeight === 0) {\n      return 0;\n    }\n\n    return this.tableOY / -tableVisibleHeight;\n  }\n\n  set t(value) {\n    this.setTableOYByPercentage(value).updateTable();\n  }\n\n  get t() {\n    return this.getTableOYPercentage();\n  }\n\n  getCell(cellIdx) {\n    return this.table.getCell(cellIdx, true);\n  }\n\n  getCellContainer(cellIdx) {\n    var cell = this.table.getCell(cellIdx, false);\n    var container;\n\n    if (cell) {\n      container = cell.getContainer();\n    }\n\n    return container;\n  }\n\n  get cellsCount() {\n    return this.table.cellsCount;\n  }\n\n  get columnCount() {\n    return this.table.colCount;\n  }\n\n  setCellHeight(cellIdx, height) {\n    var cell;\n\n    if (typeof cellIdx === 'number') {\n      cell = this.table.getCell(cellIdx, true);\n    } else {\n      cell = cellIdx;\n    }\n\n    cell.height = height; // Only worked when scrollMode is 0\n\n    return this;\n  }\n\n  setCellWidth(cellIdx, width) {\n    var cell;\n\n    if (typeof cellIdx === 'number') {\n      cell = this.table.getCell(cellIdx, true);\n    } else {\n      cell = cellIdx;\n    }\n\n    cell.width = width; // Only worked when scrollMode is 1\n\n    return this;\n  }\n\n  setCellsMask(config) {\n    var maskEnable, maskPadding, maskUpdateMode;\n\n    if (config === true) {\n      maskEnable = true;\n      maskPadding = 0;\n      maskUpdateMode = 0;\n    } else if (config === false) {\n      maskEnable = false;\n    } else {\n      maskEnable = GetValue(config, 'mask', true);\n      maskPadding = GetValue(config, 'padding', 0);\n      maskUpdateMode = GetValue(config, 'updateMode', 0);\n    }\n\n    this.maskUpdateMode = maskUpdateMode; // 0,1,undefined\n\n    if (maskEnable) {\n      var maskGameObject = new DefaultMask(this, 0, maskPadding);\n      this.cellsMask = maskGameObject.createGeometryMask();\n      this.add(maskGameObject);\n\n      if (typeof maskUpdateMode === 'string') {\n        maskUpdateMode = MASKUPDATEMODE[maskUpdateMode];\n      }\n\n      if (maskUpdateMode === 1) {\n        this.scene.game.events.on('poststep', this.maskCells, this);\n      }\n    }\n\n    return this;\n  }\n\n  get instHeight() {\n    return this.scrollMode === 0 ? this.height : this.width;\n  }\n\n  get instWidth() {\n    return this.scrollMode === 0 ? this.width : this.height;\n  }\n\n  get tableHeight() {\n    return this.table.totalRowsHeight;\n  }\n\n  get tableWidth() {\n    return this.table.totalColumnWidth;\n  }\n\n  get topTableOY() {\n    return 0;\n  }\n\n  get bottomTableOY() {\n    return -this.tableVisibleHeight;\n  }\n\n  get leftTableOX() {\n    return 0;\n  }\n\n  get rightTableOX() {\n    return -this.tableVisibleWidth;\n  }\n\n  get tableVisibleHeight() {\n    var h;\n    var tableHeight = this.tableHeight;\n    var instHeight = this.instHeight;\n\n    if (tableHeight > instHeight) {\n      h = tableHeight - instHeight;\n    } else {\n      h = 0;\n    }\n\n    return h;\n  }\n\n  get tableVisibleWidth() {\n    var w;\n    var tableWidth = this.tableWidth;\n    var instWidth = this.instWidth;\n\n    if (tableWidth > instWidth) {\n      w = tableWidth - instWidth;\n    } else {\n      w = 0;\n    }\n\n    return w;\n  }\n\n  get bottomLeftY() {\n    return -(this.displayHeight * this.originY) + this.displayHeight;\n  }\n\n  get topRightX() {\n    return -(this.displayWidth * this.originX) + this.displayWidth;\n  }\n\n  get topLeftX() {\n    return -(this.displayWidth * this.originX);\n  }\n\n  get topLeftY() {\n    return -(this.displayHeight * this.originY);\n  }\n\n  get bottomBound() {\n    if (this.scrollMode === 0) {\n      return this.bottomLeftY;\n    } else {\n      return this.topRightX;\n    }\n  }\n\n  get rightBound() {\n    if (this.scrollMode === 0) {\n      return this.topRightX;\n    } else {\n      return this.bottomLeftY;\n    }\n  }\n\n  resize(width, height) {\n    if (this.width === width && this.height === height) {\n      return this;\n    }\n\n    super.resize(width, height);\n\n    if (this.cellsMask) {\n      ResizeGameObject(MaskToGameObject(this.cellsMask), width, height);\n    }\n\n    if (this.expandCellSize) {\n      this.table.setDefaultCellWidth(this.instWidth / this.table.colCount);\n    }\n\n    this.updateTable(true);\n    return this;\n  }\n\n}\n\n; // mixin\n\nObject.assign(GridTable.prototype, Components.GetBounds, Methods);\nconst SCROLLMODE = {\n  v: 0,\n  vertical: 0,\n  h: 1,\n  horizontal: 1\n};\nconst MASKUPDATEMODE = {\n  update: 0,\n  everyTick: 1\n};\nexport default GridTable;","map":{"version":3,"sources":["/home/jon/code/Projects/Soulys/frontend/node_modules/phaser3-rex-plugins/plugins/gameobjects/gridtable/GridTable.js"],"names":["ContainerLite","Table","DefaultMask","ResizeGameObject","MaskToGameObject","Methods","Group","Phaser","GameObjects","Components","Set","Structs","GetValue","Utils","Objects","GridTable","constructor","scene","x","y","width","height","config","undefined","type","_tableOX","_tableOY","visibleCells","preVisibleCells","execeedTopState","execeedBottomState","execeedLeftState","execeedRightState","reuseCellContainer","cellContainersPool","callback","scope","on","setCellsMask","setScrollMode","setClampMode","scrollMode","cellWidth","expandCellSize","columns","cellHeight","table","updateTable","destroy","fromScene","maskUpdateMode","game","events","off","maskCells","mode","SCROLLMODE","toLowerCase","clampTableOXYMode","tableOY","tableOX","oy","setTableOY","ox","setTableOX","setTableOXY","addTableOY","dy","addTableOX","dx","addTableOXY","setTableOYByPercentage","percentage","tableVisibleHeight","getTableOYPercentage","t","value","getCell","cellIdx","getCellContainer","cell","container","getContainer","cellsCount","columnCount","colCount","setCellHeight","setCellWidth","maskEnable","maskPadding","maskGameObject","cellsMask","createGeometryMask","add","MASKUPDATEMODE","instHeight","instWidth","tableHeight","totalRowsHeight","tableWidth","totalColumnWidth","topTableOY","bottomTableOY","leftTableOX","rightTableOX","tableVisibleWidth","h","w","bottomLeftY","displayHeight","originY","topRightX","displayWidth","originX","topLeftX","topLeftY","bottomBound","rightBound","resize","setDefaultCellWidth","Object","assign","prototype","GetBounds","v","vertical","horizontal","update","everyTick"],"mappings":"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","sourcesContent":["import ContainerLite from '../containerlite/ContainerLite.js';\r\nimport Table from './Table.js';\r\nimport DefaultMask from '../../utils/mask/DefaultMask.js';\r\nimport ResizeGameObject from '../../utils/size/ResizeGameObject.js';\r\nimport MaskToGameObject from '../../utils/mask/MaskToGameObject.js';\r\nimport Methods from './methods/Methods.js';\r\n\r\nconst Group = Phaser.GameObjects.Group;\r\nconst Components = Phaser.GameObjects.Components;\r\nconst Set = Phaser.Structs.Set;\r\nconst GetValue = Phaser.Utils.Objects.GetValue;\r\n\r\nclass GridTable extends ContainerLite {\r\n    constructor(scene, x, y, width, height, config) {\r\n        if (config === undefined) {\r\n            config = {};\r\n        }\r\n        super(scene, x, y, width, height);\r\n        this.type = 'rexGridTable';\r\n        this._tableOX = 0;\r\n        this._tableOY = 0;\r\n        this.visibleCells = new Set();\r\n        this.preVisibleCells = new Set();\r\n        this.execeedTopState = false;\r\n        this.execeedBottomState = false;\r\n        this.execeedLeftState = false;\r\n        this.execeedRightState = false;\r\n\r\n        var reuseCellContainer = GetValue(config, 'reuseCellContainer', false);\r\n        if (reuseCellContainer) {\r\n            this.cellContainersPool = new Group(scene); // Don't add Group into update list, I will destroy it manually\r\n        }\r\n\r\n        var callback = GetValue(config, 'cellVisibleCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'cellVisibleCallbackScope', undefined);\r\n            this.on('cellvisible', callback, scope);\r\n        }\r\n        callback = GetValue(config, 'cellInvisibleCallback', null);\r\n        if (callback !== null) {\r\n            var scope = GetValue(config, 'cellInvisibleCallbackScope', undefined);\r\n            this.on('cellinvisible', callback, scope);\r\n        }\r\n\r\n        this.setCellsMask(GetValue(config, 'mask', true));\r\n\r\n        this.setScrollMode(GetValue(config, 'scrollMode', 0));\r\n        this.setClampMode(GetValue(config, 'clamplTableOXY', true));\r\n\r\n        // Pre-process cell size\r\n        if (this.scrollMode === 0) { // scroll y\r\n            var cellWidth = GetValue(config, 'cellWidth', undefined);\r\n            this.expandCellSize = (cellWidth === undefined);\r\n            if (cellWidth === undefined) {\r\n                var columns = GetValue(config, 'columns', 1);\r\n                config.cellWidth = this.width / columns;\r\n            }\r\n        } else { // scroll x\r\n            // Swap cell width and cell height\r\n            var cellWidth = GetValue(config, 'cellHeight', undefined);\r\n            var cellHeight = GetValue(config, 'cellWidth', undefined);\r\n            this.expandCellSize = (cellWidth === undefined);\r\n            config.cellWidth = cellWidth;\r\n            config.cellHeight = cellHeight;\r\n        }\r\n        this.table = new Table(this, config);\r\n\r\n        this.updateTable();\r\n    }\r\n\r\n    destroy(fromScene) {\r\n        //  This Game Object has already been destroyed\r\n        if (!this.scene) {\r\n            return;\r\n        }\r\n\r\n        if (this.maskUpdateMode === 1) {\r\n            this.scene.game.events.off('poststep', this.maskCells, this);\r\n        }\r\n\r\n        this.table.destroy(fromScene);\r\n        this.table = undefined;\r\n        if (this.cellContainersPool) {\r\n            this.cellContainersPool.destroy(true);\r\n            this.cellContainersPool = undefined;\r\n        }\r\n        super.destroy(fromScene);\r\n    }\r\n\r\n    setScrollMode(mode) {\r\n        if (typeof (mode) === 'string') {\r\n            mode = SCROLLMODE[mode.toLowerCase()];\r\n        }\r\n        this.scrollMode = mode;\r\n        return this;\r\n    }\r\n\r\n    setClampMode(mode) {\r\n        this.clampTableOXYMode = mode;\r\n        return this;\r\n    }\r\n\r\n    get tableOY() {\r\n        return this._tableOY;\r\n    }\r\n\r\n    get tableOX() {\r\n        return this._tableOX;\r\n    }\r\n\r\n    set tableOY(oy) {\r\n        this.setTableOY(oy).updateTable();\r\n    }\r\n\r\n    set tableOX(ox) {\r\n        this.setTableOX(ox).updateTable();\r\n    }\r\n\r\n    setTableOXY(ox, oy) {\r\n        this.setTableOY(oy).setTableOX(ox);\r\n        return this;\r\n    }\r\n\r\n    addTableOY(dy) {\r\n        this.setTableOY(this.tableOY + dy);\r\n        return this;\r\n    }\r\n\r\n    addTableOX(dx) {\r\n        this.setTableOX(this.tableOX + dx);\r\n        return this;\r\n    }\r\n\r\n    addTableOXY(dx, dy) {\r\n        this.addTableOY(dy).addTableOX(dx);\r\n        return this;\r\n    }\r\n\r\n    setTableOYByPercentage(percentage) {\r\n        this.setTableOY(-this.tableVisibleHeight * percentage);\r\n        return this;\r\n    }\r\n\r\n    getTableOYPercentage() {\r\n        var tableVisibleHeight = this.tableVisibleHeight;\r\n        if (tableVisibleHeight === 0) {\r\n            return 0;\r\n        }\r\n        return (this.tableOY / -tableVisibleHeight);\r\n    }\r\n\r\n    set t(value) {\r\n        this.setTableOYByPercentage(value).updateTable();\r\n    }\r\n\r\n    get t() {\r\n        return this.getTableOYPercentage();\r\n    }\r\n\r\n    getCell(cellIdx) {\r\n        return this.table.getCell(cellIdx, true);\r\n    }\r\n\r\n    getCellContainer(cellIdx) {\r\n        var cell = this.table.getCell(cellIdx, false);\r\n        var container;\r\n        if (cell) {\r\n            container = cell.getContainer();\r\n        }\r\n        return container;\r\n    }\r\n\r\n    get cellsCount() {\r\n        return this.table.cellsCount;\r\n    }\r\n\r\n    get columnCount() {\r\n        return this.table.colCount;\r\n    }\r\n\r\n    setCellHeight(cellIdx, height) {\r\n        var cell;\r\n        if (typeof (cellIdx) === 'number') {\r\n            cell = this.table.getCell(cellIdx, true);\r\n        } else {\r\n            cell = cellIdx;\r\n        }\r\n        cell.height = height; // Only worked when scrollMode is 0\r\n        return this;\r\n    }\r\n\r\n    setCellWidth(cellIdx, width) {\r\n        var cell;\r\n        if (typeof (cellIdx) === 'number') {\r\n            cell = this.table.getCell(cellIdx, true);\r\n        } else {\r\n            cell = cellIdx;\r\n        }\r\n        cell.width = width; // Only worked when scrollMode is 1\r\n        return this;\r\n    }\r\n\r\n    setCellsMask(config) {\r\n        var maskEnable, maskPadding, maskUpdateMode;\r\n        if (config === true) {\r\n            maskEnable = true;\r\n            maskPadding = 0;\r\n            maskUpdateMode = 0;\r\n        } else if (config === false) {\r\n            maskEnable = false;\r\n        } else {\r\n            maskEnable = GetValue(config, 'mask', true);\r\n            maskPadding = GetValue(config, 'padding', 0);\r\n            maskUpdateMode = GetValue(config, 'updateMode', 0);\r\n        }\r\n\r\n        this.maskUpdateMode = maskUpdateMode; // 0,1,undefined\r\n        if (maskEnable) {\r\n            var maskGameObject = new DefaultMask(this, 0, maskPadding);\r\n            this.cellsMask = maskGameObject.createGeometryMask();\r\n            this.add(maskGameObject);\r\n            if (typeof (maskUpdateMode) === 'string') {\r\n                maskUpdateMode = MASKUPDATEMODE[maskUpdateMode];\r\n            }\r\n            if (maskUpdateMode === 1) {\r\n                this.scene.game.events.on('poststep', this.maskCells, this);\r\n            }\r\n        }\r\n\r\n        return this;\r\n    }\r\n\r\n    get instHeight() {\r\n        return (this.scrollMode === 0) ? this.height : this.width;\r\n    }\r\n\r\n    get instWidth() {\r\n        return (this.scrollMode === 0) ? this.width : this.height;\r\n    }\r\n\r\n    get tableHeight() {\r\n        return this.table.totalRowsHeight;\r\n    }\r\n\r\n    get tableWidth() {\r\n        return this.table.totalColumnWidth;\r\n    }\r\n\r\n    get topTableOY() {\r\n        return 0;\r\n    }\r\n\r\n    get bottomTableOY() {\r\n        return -this.tableVisibleHeight;\r\n    }\r\n\r\n    get leftTableOX() {\r\n        return 0;\r\n    }\r\n\r\n    get rightTableOX() {\r\n        return -this.tableVisibleWidth;\r\n    }\r\n\r\n    get tableVisibleHeight() {\r\n        var h;\r\n        var tableHeight = this.tableHeight;\r\n        var instHeight = this.instHeight;\r\n        if (tableHeight > instHeight) {\r\n            h = tableHeight - instHeight;\r\n        } else {\r\n            h = 0;\r\n        }\r\n\r\n        return h;\r\n    }\r\n\r\n    get tableVisibleWidth() {\r\n        var w;\r\n        var tableWidth = this.tableWidth;\r\n        var instWidth = this.instWidth;\r\n        if (tableWidth > instWidth) {\r\n            w = tableWidth - instWidth;\r\n        } else {\r\n            w = 0;\r\n        }\r\n        return w;\r\n    };\r\n\r\n    get bottomLeftY() {\r\n        return -(this.displayHeight * this.originY) + this.displayHeight;\r\n    }\r\n\r\n    get topRightX() {\r\n        return -(this.displayWidth * this.originX) + this.displayWidth;\r\n    }\r\n\r\n    get topLeftX() {\r\n        return -(this.displayWidth * this.originX);\r\n    }\r\n\r\n    get topLeftY() {\r\n        return -(this.displayHeight * this.originY)\r\n    }\r\n\r\n    get bottomBound() {\r\n        if (this.scrollMode === 0) {\r\n            return this.bottomLeftY;\r\n        } else {\r\n            return this.topRightX;\r\n        }\r\n    }\r\n\r\n    get rightBound() {\r\n        if (this.scrollMode === 0) {\r\n            return this.topRightX;\r\n        } else {\r\n            return this.bottomLeftY;\r\n        }\r\n    }\r\n\r\n    resize(width, height) {\r\n        if ((this.width === width) && (this.height === height)) {\r\n            return this;\r\n        }\r\n\r\n        super.resize(width, height);\r\n        if (this.cellsMask) {\r\n            ResizeGameObject(MaskToGameObject(this.cellsMask), width, height);\r\n        }\r\n\r\n        if (this.expandCellSize) {\r\n            this.table.setDefaultCellWidth(this.instWidth / this.table.colCount);\r\n        }\r\n        this.updateTable(true);\r\n        return this;\r\n    }\r\n};\r\n\r\n// mixin\r\nObject.assign(\r\n    GridTable.prototype,\r\n    Components.GetBounds,\r\n    Methods\r\n);\r\n\r\nconst SCROLLMODE = {\r\n    v: 0,\r\n    vertical: 0,\r\n    h: 1,\r\n    horizontal: 1\r\n};\r\n\r\nconst MASKUPDATEMODE = {\r\n    update: 0,\r\n    everyTick: 1\r\n};\r\n\r\nexport default GridTable;"]},"metadata":{},"sourceType":"module"}